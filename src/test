#include "Arduino.h"
#include "soc/soc.h"          // Disable brownout problems
#include "soc/rtc_cntl_reg.h" // Disable brownout problems

#define analog_pin GPIO_NUM_12

void setup()
{
  // GPIO_NUM_12 neco dela ale ne moc..
  WRITE_PERI_REG(RTC_CNTL_BROWN_OUT_REG, 0); //disable brownout detector

  // Available ESP32-CAM RTC GPIOs are: 12, 13, 14 and 15
  pinMode(analog_pin, INPUT);

  Serial.begin(115200);
}

void loop()
{
  int raw = analogRead(analog_pin);
  float volt = raw / 4095.0f;
  float batteryVoltage = volt * 4.2;

  float batteryLevel = map(raw, 0.0f, 4095.0f, 0, 100);

  Serial.print("Analog: ");
  Serial.print(raw);
  Serial.print(" Battery Voltage:   ");
  Serial.print(batteryVoltage);
  Serial.print("   Battery Level:   ");
  Serial.print(batteryLevel);
  Serial.println(" %");
  delay(5000);
}

// 5.9.2019 21:00 4.11V
// 6.9.2019 21:00 3.94V
